horizontal-padding = 16px
history-width = 300px
editor-width = 440px
editor-height = 150px
topbar-height = 57px
middlebar-height = 39px

$primary-color = #1abc9c
$alert-color = #E13329
$topbar-bg = #222
$body-font-color = #34495e
$table-head-bg = #fff
$table-head-font-color = #2E383C
$table-head-padding = 0 horizontal-padding
$table-head-font-weight = bold
$table-head-font-size = 16px
$table-row-padding = 0 horizontal-padding
$table-row-font-color = #748287
$table-row-font-size = 14px
$table-even-row-bg = #F7f8f8
$topbar-title-font-size = 20px
$topbar-title-weight = normal
$topbar-height = topbar-height
$topbar-link-font-size = 16px
$topbar-link-hover-lightness = 0
$topbar-dropdown-bg = $primary-color

@import 'foundation'
@import 'nib'
global-reset()

size(w, h)
  width: w
  height: h

stretch()
  position absolute
  top 0
  left 0
  right 0
  bottom 0

transist(property)
  transition: property 0.4s
  transition-timing-function: cubic-bezier(0.694, 0.0482, 0.335, 1)

html, body
  margin 0
  padding 0

*
  outline: none

body
  font: 16px Lato, 'Helvetica Neue', Helvetica, Arial, sans-serif
  background: #222
  color: #34495e
  stretch()
  overflow: hidden

h1
  image: '/images/logo.png' 22px 28px
  background-repeat: no-repeat
  background-position: 17px 14px
  padding-left: 30px

table
  width: 100%
  th
    border-bottom: 1px solid #ECF0F1
  thead tr th, tfoot tr th
    line-height: topbar-height
    font-weight: bold
  tbody tr td, tr td, tfoot tr td
    vertical-align: top
    line-height: 1.3 * $table-row-font-size
    padding: ((middlebar-height - 1.3 * $table-row-font-size) / 2) horizontal-padding

@keyframes spinning
  from
    transform: rotate(0deg)
    transform-origin: 50% 50%
  to
    transform-origin: 50% 50%
    transform: rotate(360deg)
.spin
  animation: spinning 1.5s linear infinite

.CodeMirror
  background-color: transparent !important
  font-size: 14px !important
  font-family: Monaco, Menlo, 'Ubuntu Mono', 'Droid Sans Mono', Consolas, monospace !important
  line-height: 22px !important
  margin: 18px horizontal-padding 18px 10px
  pre
    padding: 0 !important
.CodeMirror-lines
  padding: 0 !important
.CodeMirror-gutters
  border: none !important
  border-right: 9px solid #fff !important
  background-color: #fff !important
.CodeMirror-linenumber
  padding: 0 !important
  color: #ccc !important
.CodeMirror
  height: auto !important
.CodeMirror-scroll
  overflow-x: auto !important
  max-height: 140px

.top-bar
  transist: margin
  z-index: 1
  background: linear-gradient(top, #333, #181818)
  .icon
    margin-right: 8px
    position: relative
    &.menu-fork
      top: 1px
    &.menu-fork
      top: 3px
  ul.right
    background-color: $topbar-bg
    .icon.history
      margin-right: 16px;
      margin-top: 19px;

.top-bar-section li a:not(.button)
  background: linear-gradient(top, #333, #181818)

.popup
  z-index 10000
  stretch()
  .background
    stretch()
    background-color #000
    opacity 0.5
  .inner
    fixed top 80px left 100px
    background-color #fff
    padding: 32px 40px
    width: 480px
    relative left 50%
    margin-left: -240px
    border-radius 6px
    box-shadow: rgba(0,0,0,0.5) 0 1px 6px
    h2, h3
      font-weight bold
    h2
      font-size 24px
      margin-bottom: 8px
    h3
      margin-bottom: 16px
      margin-top: 24px
    li
      overflow hidden
      margin-bottom 4px
      .left-col
        float left
        width: 30%
      .right-col
        float left
        width: 70%
    .key
      display: inline-block
      min-width: 24px
      padding: 5px 6px
      font-size: 14px
      line-height: 1
      color: #eee
      text-align: center
      text-shadow: 0 1px 0 rgba(0,0,0,0.5)
      text-transform: capitalize
      background-color: #333
      border-radius: 3px
      box-shadow: inset 0 -2px 0 #111
      .single
        width: 80px

#history
  color: #fff
  position: absolute
  top: $topbar-height
  right: left
  width: history-width
  bottom: 0
  background-color: #3A4549
  .icon.history-close
    absolute: top 21px right 17px
  h3, h4, h5
    position: relative
    color: #fff
    text-transform: uppercase;
    font-weight: bold;
    padding: 0 horizontal-padding;
    margin: 0;
    line-height: 57px
  h3
    font-size: 17px
  h4
    background-color: #2E383C
    line-height: 39px;
    font-size: 14px
    .icon.folder-add
      absolute: top 11px right 15px
  h5
    line-height: 35px;
    font-size: 12px
    line-height: 39px;
    font-size: 14px
    padding-left: 42px
    border-bottom: 1px solid #465054
    &:after
      content: ' '
      position: absolute
      size 15px 14px
      top: 12px
      left: 15px
      background-image: url('/images/icon-folder-open.png')
    .icon.folder-trash
      absolute: top 11px right 17px


  .icon.close-history
    absolute: top 20px right 16px
  ul
    li
      background-color: #3a4549
      padding: 12px horizontal-padding 16px
      position: relative
      border-bottom: 1px solid #465054
      &:after
        content: ' '
        stretch()
        background-color: #C9F9A1
        width 0
        opacity 0
      &:last-child
        border-bottom: none
      &.active
        &:after
          width 4px
          opacity 1
        background-color: #404C50
        .contents a
          color: #fff
      &:hover
        .contents a
          color: #fff
      .background
        stretch()
      .star
        z-index 2
        absolute: right 16px top 15px
        width image-size('icon-star.png')[0]
        height image-size('icon-star.png')[1]
        background: url('/images/icon-star.png') 0 0 no-repeat
        &:hover
          background-image: url('/images/icon-star_hover.png')
      .refresh
        z-index 2
        absolute: right 40px top 16px
        width image-size('icon-query-refresh.png')[0]
        height image-size('icon-query-refresh.png')[1]
        background: url('/images/icon-query-refresh.png') 0 0 no-repeat
        &:hover
          background-image: url('/images/icon-query-refresh_hover.png')
        &.running
          background: url('/images/icon-query-running.png') 0 0 no-repeat
      .contents
        position relative
        z-index 1
        line-height 1
        a
          color #9AA7AC
          font-size 16px
          width: 214px
          display: inline-block
          line-height: 1.4
        .meta
          color: #728187
          font-size: 12px
          margin-top 3px
          .icon
            relative: top 1px
            margin-right: 4px
  ul.indented
    li
      padding-left: 42px
  ul.starred li .star
    background-image: url('/images/icon-starred.png')
    &:hover
      background-image: url('/images/icon-starred_hover.png')

  .file-drop-area
    background-color: #555
    min-height: 50px
    &.active
      background-color: #fff
#views
  position: absolute
  overflow: hidden
  top: topbar-height
  bottom: 0
  left: 0
  right: 0
  box-shadow: rgba(0,0,0,0.25) -2px 0 11px;
  z-index: 10
  transist all
  #view-background
    stretch()
    background-color: #222
    transist all

.view
  position: absolute
  top: 0
  bottom: 0
  left: 0
  right: 0
  &.anim
    transform: scale(0.9, 0.9)
  &.outside
    transform: translate(0, -1000px)
  &.enter
    transform: translate(0, 0)

  .view-editor
    background-color: #fff
    border-right: 1px solid #E2E6E7
    position: absolute;
    top: 0
    left: 0
    right: 0
    height: editor-height
    border-bottom: 1px solid #E2E6E7
    transist width
    //width: editor-width
    .icon.editor-refresh
      absolute: top 16px right 16px
      z-index: 10000
    .handle
      position: absolute
      size 56px 41px
      top: 7px
      right: -40px
      background-image: url('/images/handle.png')
      z-index: 1000
      transist all
      &:after
        content: ' '
        position: absolute
        size 9px 14px
        top: 14px
        right: 18px
        background-image: url('/images/triangle.png')
        z-index: 1000
        transist all



  .view-result
    position: absolute;
    top: editor-height
    bottom: 0
    right: 0
    left: 0
    transist left
    background: #F5F6F6 url('/images/background-pending.png') 50% 50% no-repeat
    z-index: 10
    &.error
      background-image: url('/images/background-error.png')
    .status-bar
      overflow: hidden
      position: absolute;
      top: 0
      height: middlebar-height
      line-height: 38px
      left: 0
      right: 0
      color: #9EA4A6
      background-color: #FAFBFB
      border-bottom: 1px solid #E2E6E7
      padding-left: horizontal-padding
      font-size: 14px
      .updated-code
        float:right
        margin-right horizontal-padding
      &.error
        color: #E74C3C
      .icon
        position: relative
        margin-right: 6px
        &.status-info
          top: 2px
        &.status-success
          top: 1px
        &.status-error
          top: 2px
        &.status-running
          top: 2px

      /*
      .icon
      absolute: top 16px
      z-index: 10
      &.expand
        right: 16px
      &.download
        right: 16px
      */
    .split-pane
      position: absolute
      top: 39px
      left: 0
      right: 0
      bottom: 0
      height: 100%
      transist: all
      &.hidden
        height: 0
      .view-result-graph
        background-color: #F5F6F6
        position: absolute
        top: 0
        left: 0
        right: 0
        height: 50%
        //transist height
        .icon.table-show
          absolute: bottom 57px right horizontal-padding
      .view-result-table
        border-top: 1px solid #E2E6E7
        background-color: #f7f7f7
        position: absolute
        bottom: 0
        left: 0
        right: 0
        height: 50%
        //transist height
        .icon.table-download
          absolute: top 17px right horizontal-padding*2+20
          &.alone
            right: horizontal-padding
        .icon.table-hide
          absolute: top 21px right horizontal-padding
        .view-result-table-scroll
          position: absolute
          top: 0
          left: 0
          right: 0
          bottom: 0
          display: block;
          overflow: scroll

.update-button
  position:absolute
  bottom: 16px
  right: 16px

// UI states

.hide-editor .view
  .view-editor
    display: none
  .view-result
    top: 0 !important

.expand-graph .view .view-result
  .view-result-graph
    height: 100%
  .view-result-table
    height: 0

.expand-table .view .view-result
  .view-result-graph
    height: 0
  .view-result-table
    height: 100%

.show-history
  .top-bar
    //margin-right: history-width
  #views, #view-background
    left: (history-width);
    //right: history-width;
    .view-editor
      .handle
        opacity: 0

#query-bar
  background-color: #edeff1
  position: absolute
  top: 0
  left: 0
  right: 0
  height: 92px
  padding 25px horizontal-padding 0

  input
    margin 0

textarea, input[type="text"], input[type="password"], input[type="datetime"], input[type="datetime-local"], input[type="date"], input[type="month"], input[type="time"], input[type="week"], input[type="number"], input[type="email"], input[type="url"], input[type="search"], input[type="tel"], input[type="color"], .uneditable-input
  border: 2px solid #bdc3c7;
  color: $body-font-color;
  font-size: 16px;
  padding: 8px 5px;
  height: 40px;
  text-indent: 6px;
  border-radius: 6px;
  box-shadow: none;
  transition: border .25s linear, color .25s linear;
  -webkit-backface-visibility: hidden;
  &:focus
    border-color: #1abc9c;
    box-shadow: none;
  &.fixed-font
    font-family: Monaco, Menlo, 'Ubuntu Mono', 'Droid Sans Mono', Consolas, monospace;

.alert-box.global
  margin-bottom: 0
  .close
    display: none


.graph-viz {
  float: left;
  width: 500px;
}

path.link {
  fill: none;
  stroke: #7F8C8D;
  stroke-width: 2px;
}

circle {
  fill: #3498DB;
  stroke: #fff;
  stroke-width: 0;
}

text {
  fill: #000;
  font: 10px sans-serif;
  pointer-events: none;
}

circle.node {
  cursor: pointer;
  stroke: #ff;
  stroke-width: 2px;
}

line.link {
  fill: none;
  stroke: #BDC3C7;
  stroke-width: 1.5px;
}

.CodeMirror.cm-s-neo
  color: #2E383C
  .cm-keyword
    color: #3498DB
  .cm-atom
    color: #9B59B6
  .cm-node
    color: #E74C3C
  .cm-string
    color: #E67E22
  .cm-variable
    color: #1ABC9C

marker
  fill: #BDC3C7

text
  fill: #fff
  .faded
    fill: #333

.node
  transist all
  circle
    fill: #1ABC9C
    stroke-width: 2px;
    stroke: #fff
    transform: scale(1.0, 1.0)
    transist all
  &:hover
    cursor: pointer
    circle
      transform: scale(1.2, 1.2)
      fill: #C7F0E6

.node.faded
  circle
    fill: #C7F0E6
  &:hover
    circle
      transform: scale(1.2, 1.2)

line.link
  fill: #BDC3C7
  &.faded
    stroke: #ECF0F1
    stroke-dasharray: 0,2 1

icon(type, do-no-hover=false)
  width image-size('icon-' + type + '.png')[0]
  height image-size('icon-' + type + '.png')[1]
  background: url('/images/icon-' + type + '.png')
  transform: scale(1.0, 1.0)
  transist all
  unless do-no-hover
    &:hover
      background: url('/images/icon-' + type + '_hover.png')
      unless do-no-scale
        transform: scale(1.2, 1.2)

.icon
  display: inline-block
  cursor: pointer
  background-repeat: no-repeat;
  &.folder-add
    icon: folder-add
  &.folder-edit
    icon: folder-edit
  &.folder-trash
    icon: folder-trash
  &.table-show
    icon: table-show
  &.table-hide
    icon: table-hide
  &.status-info
    icon: status-info no-hover
  &.status-success
    icon: status-success no-hover
  &.status-error
    icon: status-error no-hover
  &.status-running
    icon: status-running no-hover
  &.editor-refresh
    icon: editor-refresh
  &.query-success
    icon: query-success no-hover
  &.query-error
    icon: query-error no-hover
  &.menu-plus
    icon: menu-plus no-hover
  &.menu-fork
    icon: menu-fork no-hover
  &.history-close
    icon: history-close
  &.table-download
    icon: table-download
  &.close-history
    icon: close-history no-hover
  &.expand
    icon expand
    &.restore
      background: url('/images/icon-restore.png')
      &:hover
        background: url('/images/icon-restore_hover.png')

.edit-in-place
  .edit-in-place-input
    border: none;
    text-transform: uppercase;
    padding: 6px 8px;
    font-family: Lato;
    font-weight: bold;
    font-size: 14px;
    border-radius: 3px;
    width: 187px;
  .edit-in-place-trigger
    @extend .icon.folder-edit
    cursor: pointer
    position: absolute
    right: 42px
    top: 11px
